{% extends "layout.html" %}

{% block title %}
    Receta Ã“ptima
{% endblock %}
{% block body_class %}book-page{% endblock %}
{% block main %}
<div class="optimizer">

  <!-- MATRIX -->
  <fieldset class="card">
    <div class="recipe-split">

      <!-- LEFT: grid -->
      <div class="recipe-left">
        <div class="recipe-left-header"><strong>Receta</strong></div>
        <div class="ingredients-grid result-grid">
          {% for i in range(alpha_matrix|length * alpha_matrix[0]|length) %}
            {% set val = alpha_matrix[i // 4][i % 4] %}
            <div class="ingredient-card {{ 'zero' if val == 0 else '' }}">
              <img
                class="ingredient-icon"
                src="{{ url_for('static', filename=ingredient_icons[i]) }}"
                alt=""
              >
              <div class="value-overlay">
                <span class="value-text">{{ val }}</span>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>

      <!-- DIVIDER -->
      <div class="recipe-divider"></div>

      <!-- RIGHT: effects list -->
      <div class="recipe-right">
        <div class="recipe-left-header"><strong>Efectos</strong></div>
        <div class="recipe-list">
          {% for i in range(out_effects|length) %}
            {% set val = out_effects[i] %}
            {% if val > 0 %}
              {% set alpha = effect_weights[i] if effect_weights is defined else 0 %}
                <div class="recipe-row" style = "--hl: {{ alpha }};">
                  <span class="recipe-row-value">{{ "%.2f"|format(val) }}%</span>
                  <img
                    class="recipe-row-icon"
                    src="{{ url_for('static', filename='effects/effect' ~ (effect_indices[i] + 1) ~ '.png') }}"
                    alt=""
                  >
                <span class="recipe-row-name" title="{{ effect_names[i] }}">
                  {{ effect_names[i] }}
                </span>
                </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>

    </div>
  </fieldset>

  <fieldset class="card">
    <div class="result-score">
      <legend><strong>Score</strong></legend>
      <span class="result-score-value">
        {{ "%.2f"|format(score) }}
      </span>
    </div>
  </fieldset>
</div>
{% endblock %}