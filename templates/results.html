{% extends "layout.html" %}

{% block title %}
    {{ _("Receta Ã“ptima") }}
{% endblock %}
{% block main %}
<div class="optimizer">

  <!-- MATRIX -->
  <fieldset class="card">
    <div class="recipe-split">

      <!-- LEFT: grid -->
      <div class="recipe-left">
        <div class="recipe-header"><strong>{{ _("Receta") }}</strong></div>
        <div class="ingredients-grid result-grid">
          {% set ns = namespace(idx=0) %}
          {% for row in alpha_matrix %}
            {% for val in row %}
              {% set ns.idx = ns.idx + 1 %}
              <div class="ingredient-card {{ 'zero' if val == 0 else '' }}">
                <img
                  class="ingredient-icon"
                  src="{{ url_for('static', filename='ingredients/ingredient_crystal' ~ ns.idx ~ '.png') }}"
                  alt=""
                >
                <div class="value-overlay">
                  <span class="value-text">{{ val }}</span>
                </div>
              </div>
            {% endfor %}
          {% endfor %}
        </div>
      </div>

      <!-- DIVIDER -->
      <div class="recipe-divider"></div>

      <!-- RIGHT: effects list -->
      <div class="recipe-right">
        <div class="recipe-header"><strong>{{ _("Efectos") }}</strong></div>
        <div class="recipe-list">
          {% for effect in effects %}
            <div class="recipe-row" style="--hl: {{ effect.weight }};">
              <span class="recipe-row-value">{{ "%.2f"|format(effect.value) }}%</span>
              <img
                class="recipe-row-icon"
                src="{{ url_for('static', filename='effects/effect' ~ (effect.index + 1) ~ '.png') }}"
                alt=""
              >
              <span class="recipe-row-name" title="{{ _(effect.name) }}">
                {{ _(effect.name) }}
              </span>
            </div>
          {% endfor %}
        </div>
      </div>

    </div>
  </fieldset>

  <fieldset class="card">
    <div class="result-score">
      <legend><strong>{{ _("Score") }}</strong></legend>
      <span class="result-score-value">
        {{ "%.2f"|format(score) }}
      </span>
    </div>
  </fieldset>

  <div class="submit-row">
    <a href="{{ url_for('index') }}" class="game-btn game-btn-main">
      <span>{{ _("Volver") }}</span>
    </a>
  </div>
</div>
{% endblock %}